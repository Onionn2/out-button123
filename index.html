<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ガキ使 ポン出し</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: #fff;
  font-family: "Hiragino Kaku Gothic ProN", "Yu Gothic", sans-serif;
}

/* ===== タブ ===== */
.tabs {
  display: flex;
}

.tab {
  flex: 1;
  padding: 14px;
  font-size: 1.2rem;
  border: none;
  background: #eee;
}

.tab.active {
  background: red;
  color: white;
}

/* ===== タイトル ===== */
.title {
  text-align: center;
  font-size: 2.4rem;
  font-weight: bold;
  margin: 24px 0;
}

/* ===== 音量 ===== */
.volume {
  padding: 0 20px 20px;
}

.volume input {
  width: 100%;
}

/* ===== 画面 ===== */
.screen {
  display: none;
  padding: 0 20px 30px;
}

.screen.active {
  display: block;
}

/* ===== ボタン共通 ===== */
.grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 18px;
}

.btn {
  height: 16vh;
  font-size: 2.2rem;
  border: none;
  border-radius: 24px;
  color: white;
}

.red { background: red; }
.darkred {
  background: #8b0000;
  grid-column: span 2;
}
.gray { background: #666; }
</style>
</head>

<body>

<!-- ===== タブ ===== -->
<div class="tabs">
  <button class="tab active" data-target="bgm">BGM</button>
  <button class="tab" data-target="out">ガキの使い</button>
  <button class="tab" data-target="se">効果音</button>
</div>

<!-- ===== 音量 ===== -->
<div class="volume">
  <input id="volume" type="range" min="0" max="1" step="0.01" value="0.8">
</div>

<!-- ===== BGM ===== -->
<div class="screen active" id="bgm">
  <div class="title">BGM</div>
  <div class="grid">
    <button class="btn red" data-key="bgm">再生</button>
    <button class="btn gray" id="bgmStop">停止</button>
  </div>
</div>

<!-- ===== ガキ使 ===== -->
<div class="screen" id="out">
  <div class="title">アウト！</div>
  <div class="grid">
    <button class="btn red" data-key="keito">けいと</button>
    <button class="btn red" data-key="sora">そら</button>
    <button class="btn red" data-key="wada">和田</button>
    <button class="btn red" data-key="sakurai">櫻井</button>
    <button class="btn darkred" data-key="all">全員アウト</button>
  </div>
</div>

<!-- ===== 効果音 ===== -->
<div class="screen" id="se">
  <div class="title">効果音</div>
  <div class="grid">
    <button class="btn red" data-key="pon">学校のチャイム</button>
    <button class="btn red" data-key="don">茶番終了</button>
    <button class="btn red" data-key="news">ニュースBGM</button>
    <button class="btn gray" id="stopAll">全停止</button>
  </div>
</div>

<script>
/* ===== iOS音声アンロック ===== */
let unlocked = false;
function unlockAudio() {
  if (unlocked) return;
  const ctx = new (window.AudioContext || window.webkitAudioContext)();
  ctx.resume();
  unlocked = true;
}

/* ===== 音量 ===== */
let masterVolume = 0.8;
document.getElementById("volume").oninput = e => {
  masterVolume = e.target.value;
  Object.values(sounds).forEach(a => a.volume = masterVolume);
};

/* ===== 音源 ===== */
const sounds = {
  bgm: new Audio("bgm.mp3"),

  keito: new Audio("keito.mp3"),
  sora: new Audio("sora.mp3"),
  wada: new Audio("wada.mp3"),
  sakurai: new Audio("sakurai.mp3"),
  all: new Audio("all.mp3"),

  pon: new Audio("school_song.mp3"),
  don: new Audio("chan.mp3"),
  news: new Audio("news.mp3")
};

sounds.bgm.loop = true;

/* ===== preload ===== */
Object.values(sounds).forEach(a => {
  a.preload = "auto";
  a.volume = masterVolume;
});

/* ===== 再生（連打OK・重ならない） ===== */
function play(key) {
  unlockAudio();
  const a = sounds[key];
  a.pause();
  a.currentTime = 0;
  a.volume = masterVolume;
  a.play().catch(()=>{});
}

/* ===== 全停止 ===== */
function stopAll() {
  Object.values(sounds).forEach(a => {
    a.pause();
    a.currentTime = 0;
  });
}

/* ===== タブ切替 ===== */
document.querySelectorAll(".tab").forEach(tab => {
  tab.onclick = () => {
    document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
    document.querySelectorAll(".screen").forEach(s => s.classList.remove("active"));
    tab.classList.add("active");
    document.getElementById(tab.dataset.target).classList.add("active");
  };
});

/* ===== ボタン処理 ===== */
document.querySelectorAll("[data-key]").forEach(btn => {
  btn.onclick = () => play(btn.dataset.key);
});

document.getElementById("bgmStop").onclick = () => {
  sounds.bgm.pause();
  sounds.bgm.currentTime = 0;
};

document.getElementById("stopAll").onclick = stopAll;
</script>

</body>
</html>
